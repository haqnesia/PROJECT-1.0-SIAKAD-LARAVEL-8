
# MODEL

php artisan make:model MasterFakultas

class MasterFakultas extends Model
{
    protected $connection   = 'mysql';
    protected $table        = 'master_ta_fakultas';
    protected $primaryKey   = 'fak_kode';
    protected $keyType      = 'string';
    public $incrementing    = false;
}

# VIEW

    Buat File tambahan pada Folder master_fakultas :

    data.blade.php
    modal_add.blade.php
    modal_edit.blade.php

# Data Tabel HTML

    Pindahkan sebagian kode index.blade.php ke data.blade.php (Card Tabel)

# AKTIFKAN MENU

    Modifikasi Tombol Tambah 

    Dari : 

        <button class="btn btn-primary btn-sm"
                data-toggle="modal"
                data-target="#formModalAdd">
            + Tambah
        </button>


    Menjadi :

    <button class="btn btn-primary btn-sm" data-act="baru">
        + Tambah
    </button>


# BUAT BLOK JS (Javascript)

    BLOK JS : 

    @section('js')
    <script>


    </script>
    @endsection


# AJAX ADD & SAVE

    AJAX ADD

    // AJAX ADD

    $(document).on('click', '[data-act=baru]', function (e) {
        e.preventDefault();

        $.get("{{ route('fakultas.add') }}")
            .done(function (r) {
                if (r.success) {
                    $('#formModalAdd .modal-content').html(r.html);
                    $('#formModalAdd').modal('show');
                } else {
                    alert(r.message);
                }
            })
            .fail(function (x) {
                alert(x.status + ' - ' + x.statusText);
            });
    });

    // AJAX SAVE

    $(document).on('submit', '#fakultas_save', function (e) {
        e.preventDefault();

        var form = this;
        $(form).find('button[type=submit]').prop('disabled', true);

        $.post($(form).attr('action'), $(form).serialize())
            .done(function (r) {
                if (r.success) {
                    $('#formModalAdd').modal('hide');
                    alert('Data berhasil disimpan');
                    view_data();
                } else {
                    alert(r.message);
                }
            })
            .fail(function (x) {
                alert(x.status + ' - ' + x.statusText);
            })
            .always(function () {
                $(form).find('button[type=submit]').prop('disabled', false);
            });
    });

# TAMBAHKAN ROUTE ADD DAN SAVE

Route::get('/add', [MasterFakultasController::class, 'add'])->name('add');
Route::post('/save', [MasterFakultasController::class, 'save'])->name('save');

# TAMBAHKAN FUNGSI ADD SAVE PADA CONTROLLER

    # FUNGSI ADD

    public function add()
    {

        $result = array('success'=>false);

        try {

            # SAAT INI BLOCK TRY MASIH KOSONG

        } catch (\Exception $e) {
            $result['message'] = $e->getMessage();	
            return response()->json($result);
        }

        $result['success']  = true;
        $result['html']     = html_normalize(view('master_fakultas.modal_add')->render());

        return response()->json($result);

    }

    # FUNGSI SAVE
           
    public function save(Request $r)
    {

        $result = array('success'=>false);

        try {

            # VALIADASI
  
            $r->validate([
                'kode' => 'required|unique:master_ta_fakultas,fak_kode',
                'nama' => 'required'
            ]);

            # PROSES SIMPAN

            $data = new MasterFakultas;

            $data->fak_kode         = $r->kode;
            $data->fak_nama         = $r->nama;

            $data->created_kode     = $this->UsersID;
            $data->created_nama     = $this->UsersName;
            $data->created_ip       = $r->ip();

            $data->updated_kode     = $this->UsersID;
            $data->updated_nama     = $this->UsersName;
            $data->updated_ip       = $r->ip();

            $data->save();


        } catch (\Exception $e) {
            $result['message'] = $e->getMessage();	
            return response()->json($result);
        }

        $result['success']  = true;
        $result['html']     = html_normalize(view('master_fakultas.modal_add',compact('data'))->render());

        return response()->json($result);

    }


    Note : 
        Sebelum simpan NONAKTIFKAN view_data pada Ajax Save
        view_data belum aktif coba cek dulu database

# TAMBAHKAN MODAL PADA INDEX

<div class="modal modal-default fade" id="formModalAdd">
    <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content" style="background-color: #ffffff"></div>
    </div>
</div>

# ISI MODAL ADD

Isi File modal_add.blade.php
pindahkan dari yang di template dan modifikasi

# AKTIFKAN SECTION CSS DAN JS PADA TEMPLATE

        @section('css')
        @show

        @section('js')
        @show


# TAMBAHKAN CONSTRUCT PADA CONTROLLER (USERS)

    # FUNGSI CONSTRUCT

    public function __construct()
    {
        $this->middleware('auth');

        $this->middleware(function ($request, $next) {
            $this->UsersID      = Auth::user()->id;
            $this->UsersName    = Auth::user()->name;
            return $next($request);
        });

    }

# TAMBAHKAN AUTH

    use Illuminate\Support\Facades\Auth;

# PANGGIL MODEL

use App\Models\MasterFakultas;


# AKTIFKAN STRTOUPPER



